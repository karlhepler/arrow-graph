var CircleGraph=function(e,t,n,l,r,s,a,i){"use strict";var c=document.documentElement.clientHeight-100,o=50,d=.1,h=100,u=10,C=.02*c,m=C/2,p=c/2-o,g=3/p,f=p-.5*p,v=3/f,y=p/2+f/2,L=3/y,M=["rgb(62, 165, 218)","rgb(137, 194, 82)","rgb(68, 176, 84)","rgb(34, 139, 75)","rgb(24, 99, 59)","rgb(55, 175, 115)","rgb(41, 162, 150)"];return function(r){function a(e){b.classList.add("CircleGraph--zoom"),b.style.width=c+"px",b.style.height=c+"px";for(var t=0,n=S.length;t<n;t++)S[t].style.display=null;e.style.display="block",_.classList.remove("CircleModal--hidden")}function i(){for(var e=0,t=B.node().children.length;e<t;e++)B.node().children[e].classList.remove("CircleSection--selected"),S[e].style.display=null;b.classList.remove("CircleGraph--zoom"),b.style.width=null,b.style.height=null,_.classList.add("CircleModal--hidden")}var S=r.getElementsByClassName("CircleModal__section"),E=l/S.length,b=r.getElementsByClassName("CircleGraph")[0],_=r.getElementsByClassName("CircleModal")[0];r.getElementsByClassName("CircleModal__close-btn")[0].addEventListener("click",function(e){i()});var G={openCircleModal:a,closeCircleModal:i},B=e.select(b).append("svg").attr("class",function(){return setTimeout(function(){b.classList.remove("CircleGraph--hidden")},200),"CircleGraph__svg"}).attr("width",c).attr("height",c).append("g").attr("transform",function(){return"translate("+[p+o,p+o]+")"}),N=B.selectAll("path").data(S).enter().append("g").attr("class","CircleSection CircleSection--hidden").on("mouseenter",function(){this.classList.contains("CircleSection--selected")||this.classList.add("CircleSection--hover")}).on("mouseleave",function(){this.classList.remove("CircleSection--hover")}).on("click",function(e){if(this.classList.remove("CircleSection--hover"),this.classList.contains("CircleSection--selected"))i();else{r.getElementsByClassName("CircleGraph")[0].classList.contains("CircleGraph---zoom")||a(e);for(var t=b.getElementsByClassName("CircleSection"),n=0,l=t.length;n<l;n++)t[n].classList.remove("CircleSection--selected");this.classList.add("CircleSection--selected")}});return N.transition().delay(function(e,t){return t*h}).attr("class","CircleSection"),N.append("path").attr("fill",function(e){return M[~~(s()*M.length)]}).attr("d",function(l,r){var s=E*r,a=E*(r+1),i=(s+d-2*L+(a+d-2*L))/2;l.centroid=[y*n(i),y*t(i)];var c=e.path();return c.moveTo(p*n(s+g),p*t(s+g)),c.arc(0,0,p,s+g,a-g),c.lineTo(y*n(a+d-L),y*t(a+d-L)),c.arc(0,0,f,a-v,s+v,!0),c.lineTo(y*n(s+d+L),y*t(s+d+L)),c.closePath(),c}),N.append("text").attr("class","CircleSection__label").attr("font-size",C).attr("transform",function(e){return"translate("+e.centroid+")"}).selectAll("tspan").data(function(e){for(var t=e.getElementsByClassName("CircleModal__title")[0].textContent.split(" "),n=[t[0]],l=0,r=1,s=t.length;r<s;r++){var a=n[l]+" "+t[r];a.length<=u?n[l]=a:(n[l]=n[l].trim(),n.push(t[r]),l++)}return n}).enter().append("tspan").attr("x",0).attr("y",function(e,t,n){return C*t-(n.length*C+(n.length-1)*m)/2+m*t}).text(function(e){return e}),G}}(d3,Math.sin,Math.cos,2*Math.PI,Math.SQRT2,Math.random);document.addEventListener("DOMContentLoaded",function(e){for(var t=document.getElementsByClassName("Circle"),n=0,l=t.length;n<l;n++)new CircleGraph(t[n])});